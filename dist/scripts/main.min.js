!function(){"use strict";angular.module("parameters.config",[]).constant("ApiSettings",{url:"https://t441.databoom.space/api1/b441/collections/"})}(),function(){"use strict";function t(t){t.defaults.headers.common.Authorization="Basic "+btoa("usr1:usr1")}angular.module("bDay",["parameters.config","ngResource"]),angular.module("bDay").config(t),t.$inject=["$httpProvider"]}(),function(){"use strict";function t(t,e){return t(e.url+"cities")}angular.module("bDay").factory("City",t),t.$inject=["$resource","ApiSettings"]}(),function(){"use strict";function t(t,e){return t(e.url+"forecast(:id)",{id:"@_id"},{update:{method:"PUT"}})}angular.module("bDay").factory("Forecast",t),t.$inject=["$resource","ApiSettings"]}(),function(){"use strict";function t(t,e){return t(e.url+"weather_types")}angular.module("bDay").factory("WeatherType",t),t.$inject=["$resource","ApiSettings"]}(),function(){"use strict";function t(){this.close=function(){console.log("close"),this.forecast=void 0}}angular.module("bDay").component("fDialog",{controller:t,bindings:{forecast:"=",action:"=",weatherTypes:"=",cities:"=",dates:"="},template:["$element","$timeout",function(t,e){return e(function(){var e=t.find("dialog")[0];e.showModal||dialogPolyfill.registerDialog(e)},1e3),'<dialog class="mdl-dialog" ng-attr-open="{{ $ctrl.forecast }}"><form ng-submit="$ctrl.action[\'submit\']($event); $ctrl.close();"><h4 class="mdl-dialog__title">{{ $ctrl.action[\'name\'] }} <span ng-if="$ctrl.action[\'type\'] === \'edit\'">({{ $ctrl.forecast.date }})</span></h4><div class="mdl-dialog__content"><div class="mdl-dropdown" ng-show="$ctrl.action[\'type\'] === \'add\'"><h6 ng-bind="$ctrl.forecast.date || \'Выберите дату\'"></h6><input class="modal-hidden-input" type="text" ng-model="$ctrl.forecast.date" required><div class="mdl-layout-spacer"></div><a id="datebtn" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"><i class="material-icons" role="presentation">arrow_drop_down</i><span class="visuallyhidden">Dates</span></a><ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="datebtn"><li class="mdl-menu__item" ng-repeat="date in $ctrl.dates" ng-if="date != $ctrl.forecast.date" ng-click="$ctrl.action[\'setDate\'](date)">{{ date }}</li></ul></div><div class="mdl-dropdown"><h6 ng-bind="$ctrl.forecast.city.name"></h6><div class="mdl-layout-spacer"></div><a id="citybtn" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"><i class="material-icons" role="presentation">arrow_drop_down</i><span class="visuallyhidden">Cities</span></a><ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="citybtn"><li class="mdl-menu__item" ng-repeat="loop_city in $ctrl.cities" ng-if="loop_city.id != $ctrl.forecast.city_id" ng-click="$ctrl.action[\'setCity\'](loop_city)">{{ loop_city.name }}</li></ul></div><div class="mdl-dropdown"><h6 ng-bind="$ctrl.forecast.type || \'Выберите тип погоды\'"></h6><input class="modal-hidden-input" type="text" ng-model="$ctrl.forecast.type" required><div class="mdl-layout-spacer"></div><a id="typebtn" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"><i class="material-icons" role="presentation">arrow_drop_down</i><span class="visuallyhidden">Weather Types</span></a><ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="typebtn"><li class="mdl-menu__item" ng-repeat="(key, value) in $ctrl.weatherTypes" ng-if="key != $ctrl.forecast.weather_type" ng-click="$ctrl.action[\'setType\'](key, value)">{{ value }}</li></ul></div><div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" ng-class="{\'is-dirty\': $ctrl.forecast.t_day !== undefined}"><input class="mdl-textfield__input" type="text" pattern="-?[0-9]*(.[0-9]+)?" id="d_temp" ng-model="$ctrl.forecast.t_day" value="0" ng-required="$ctrl.forecast"><label class="mdl-textfield__label" for="d_temp">Day temperature</label><span class="mdl-textfield__error">Input is not a number!</span></div><div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" ng-class="{\'is-dirty\': $ctrl.forecast.t_night !== undefined}"><input class="mdl-textfield__input" type="text" pattern="-?[0-9]*(.[0-9]+)?" id="n_temp" ng-model="$ctrl.forecast.t_night" ng-required="$ctrl.forecast"><label class="mdl-textfield__label" for="n_temp">Night temperature</label><span class="mdl-textfield__error">Input is not a number!</span></div></div><div class="mdl-dialog__actions"><button type="submit" class="mdl-button">Apply</button><a type="button" class="mdl-button close" ng-click="$ctrl.close()">Cancel</button></div></form></dialog>'}]})}(),function(){"use strict";function t(t,e,i,n,a,l){function o(t,e){Object.keys(t).forEach(function(i){e[i]=t[i]})}function c(e,i){t.modalAction.type=e,t.modalAction.name="edit"===e?"Edit":"Add",t.modalAction.submit=i}function s(t,e){return e.find(function(e){return parseInt(e.day,10)===t})}function d(e){t.dates=[];var i=t.forecast.filter(function(t){return parseInt(t.city_id,10)===parseInt(e.id,10)&&t.day});if(i.length)for(var n=parseInt(i[0].day,10);n<=31;n++)s(n,i)||t.dates.push((n<10?"0"+n:String(n))+".10.2016")}function r(){t.forecast.sort(function(t,e){if(!t.date)return-1;if(!e.date)return 1;var i=Date.parse(t.date.replace(/(\d{2})\.(\d{2})\.(\d{4})/,"$2/$1/$3")),n=Date.parse(e.date.replace(/(\d{2})\.(\d{2})\.(\d{4})/,"$2/$1/$3"));return i>n?1:i<n?-1:0})}function u(t){return t?t.split(".")[0]:""}t.isLoading=!0,t.city=void 0,t.cities=[],t.weatherTypes={},t.forecast=[],t.selectedForecast=void 0,t.today=e("date")(new Date,"dd.MM.yyyy"),t.modalAction={},n.get(function(e){t.cities=e.d.results,t.city=t.cities[0]}),a.get(function(e){var i=e.d.results;i.forEach(function(e){t.weatherTypes[e.code]=e.name}),l.get(function(e){t.forecast=e.d.results,t.forecast.forEach(function(e){e.day=u(e.date),e.isNow=e.date===t.today||void 0,e.type=t.weatherTypes[e.weather_type]}),r(),t.forecast=t.forecast.filter(function(t){return t.date&&t.weather_type})})}),t.setCity=function(e){t.city=e},t.deleteForecast=function(e){l.remove({id:e.id},function(){t.forecast.splice(t.forecast.indexOf(e),1)})},t.openModal=function(e){function i(t){e.city=t,e.city_id=t.id}function n(t){e.date=t,e.day=u(t)}e?(i(t.city),c("edit",function(t){t.preventDefault(),l.update({id:e.id},e)})):(e={},i(t.city),c("add",function(){var i=new l;o(e,i),i.$save(),t.forecast.push(e),r()})),t.modalAction.setCity=function(a){i(a),d(e.city),e.date&&n(t.dates[0])},t.modalAction.setType=function(t,i){e.weather_type=t,e.type=i},t.modalAction.setDate=n,d(e.city),t.selectedForecast=e},i(function(){t.isLoading=!1},1e3),t.dates=[]}angular.module("bDay").controller("ForecastController",t),t.$inject=["$scope","$filter","$timeout","City","WeatherType","Forecast"]}();
//# sourceMappingURL=main.min.js.map
